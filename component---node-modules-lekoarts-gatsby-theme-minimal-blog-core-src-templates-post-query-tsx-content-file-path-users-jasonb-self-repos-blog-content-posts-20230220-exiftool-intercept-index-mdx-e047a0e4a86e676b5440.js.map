{"version":3,"file":"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-users-jasonb-self-repos-blog-content-posts-20230220-exiftool-intercept-index-mdx-e047a0e4a86e676b5440.js","mappings":"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","sources":["webpack://blog/./node_modules/@lekoarts/gatsby-theme-minimal-blog/src/components/post-footer.tsx","webpack://blog/./node_modules/@lekoarts/gatsby-theme-minimal-blog/src/components/post.tsx","webpack://blog/./node_modules/@lekoarts/gatsby-theme-minimal-blog/src/@lekoarts/gatsby-theme-minimal-blog-core/components/post.tsx","webpack://blog/./node_modules/@lekoarts/gatsby-theme-minimal-blog/src/components/item-tags.tsx","webpack://blog/./node_modules/@lekoarts/gatsby-theme-minimal-blog/src/components/seo.tsx","webpack://blog/./content/posts/20230220-exiftool-intercept/index.mdx","webpack://blog/./node_modules/@lekoarts/gatsby-theme-minimal-blog-core/src/templates/post-query.tsx","webpack://blog/./node_modules/@babel/runtime/helpers/esm/objectDestructuringEmpty.js"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-unused-vars */\nimport * as React from \"react\"\nimport type { MBPostProps } from \"./post\"\n\nconst PostFooter = ({ post }: MBPostProps) => null\n\nexport default PostFooter\n","/** @jsx jsx */\nimport type { HeadFC, PageProps } from \"gatsby\"\nimport * as React from \"react\"\nimport { jsx, Heading } from \"theme-ui\"\nimport Layout from \"./layout\"\nimport ItemTags from \"./item-tags\"\nimport Seo from \"./seo\"\nimport PostFooter from \"./post-footer\"\n\nimport replaceSlashes from \"../utils/replaceSlashes\"\nimport useMinimalBlogConfig from \"../hooks/use-minimal-blog-config\"\n\nexport type MBPostProps = {\n  post: {\n    slug: string\n    title: string\n    date: string\n    tags?: {\n      name: string\n      slug: string\n    }[]\n    description?: string\n    canonicalUrl?: string\n    excerpt: string\n    timeToRead?: number\n    banner?: {\n      childImageSharp: {\n        resize: {\n          src: string\n        }\n      }\n    }\n  }\n}\n\nconst px = [`16px`, `8px`, `4px`]\nconst shadow = px.map((v) => `rgba(0, 0, 0, 0.1) 0px ${v} ${v} 0px`)\n\nconst Post: React.FC<React.PropsWithChildren<PageProps<MBPostProps>>> = ({ data: { post }, children }) => (\n  <Layout>\n    <Heading as=\"h1\" variant=\"styles.h1\">\n      {post.title}\n    </Heading>\n    <p sx={{ color: `secondary`, mt: 3, a: { color: `secondary` }, fontSize: [1, 1, 2] }}>\n      <time>{post.date}</time>\n      {post.tags && (\n        <React.Fragment>\n          {` — `}\n          <ItemTags tags={post.tags} />\n        </React.Fragment>\n      )}\n      {post.timeToRead && ` — `}\n      {post.timeToRead && <span>{post.timeToRead} min read</span>}\n    </p>\n    <section\n      sx={{\n        my: 5,\n        \".gatsby-resp-image-wrapper\": {\n          my: [4, 4, 5],\n          borderRadius: `4px`,\n          boxShadow: shadow.join(`, `),\n          \".gatsby-resp-image-image\": {\n            borderRadius: `4px`,\n          },\n        },\n        variant: `layout.content`,\n      }}\n    >\n      {children}\n    </section>\n    <PostFooter post={post} />\n  </Layout>\n)\n\nexport default Post\n\nexport const Head: HeadFC<MBPostProps> = ({ data: { post } }) => {\n  const { basePath, blogPath } = useMinimalBlogConfig()\n\n  return (\n    <Seo\n      title={post.title}\n      description={post.description ? post.description : post.excerpt}\n      image={post.banner ? post.banner?.childImageSharp?.resize?.src : undefined}\n      pathname={replaceSlashes(`/${basePath}/${blogPath}/${post.slug}`)}\n      canonicalUrl={post.canonicalUrl}\n    />\n  )\n}\n","import type { PageProps } from \"gatsby\"\nimport * as React from \"react\"\nimport Post, { Head, MBPostProps } from \"../../../components/post\"\n\nexport default function MinimalBlogCorePost({ ...props }: PageProps<MBPostProps>) {\n  return <Post {...props} />\n}\n\nexport { Head }\n","/** @jsx jsx */\nimport { jsx } from \"theme-ui\"\nimport * as React from \"react\"\nimport { Link } from \"gatsby\"\nimport useMinimalBlogConfig from \"../hooks/use-minimal-blog-config\"\nimport replaceSlashes from \"../utils/replaceSlashes\"\n\ntype TagsProps = {\n  tags: {\n    name: string\n    slug: string\n  }[]\n}\n\nconst ItemTags = ({ tags }: TagsProps) => {\n  const { tagsPath, basePath } = useMinimalBlogConfig()\n\n  return (\n    <React.Fragment>\n      {tags.map((tag, i) => (\n        <React.Fragment key={tag.slug}>\n          {!!i && `, `}\n          <Link sx={(t) => ({ ...t.styles?.a })} to={replaceSlashes(`/${basePath}/${tagsPath}/${tag.slug}`)}>\n            {tag.name}\n          </Link>\n        </React.Fragment>\n      ))}\n    </React.Fragment>\n  )\n}\n\nexport default ItemTags\n","import * as React from \"react\"\nimport { withPrefix } from \"gatsby\"\nimport useSiteMetadata from \"../hooks/use-site-metadata\"\n\ntype SEOProps = {\n  title?: string\n  description?: string\n  pathname?: string\n  image?: string\n  children?: React.ReactNode\n  canonicalUrl?: string\n}\n\nconst Seo = ({\n  title = ``,\n  description = ``,\n  pathname = ``,\n  image = ``,\n  children = null,\n  canonicalUrl = ``,\n}: SEOProps) => {\n  const site = useSiteMetadata()\n\n  const {\n    siteTitle,\n    siteTitleAlt: defaultTitle,\n    siteUrl,\n    siteDescription: defaultDescription,\n    siteImage: defaultImage,\n    author,\n  } = site\n\n  const seo = {\n    title: title ? `${title} | ${siteTitle}` : defaultTitle,\n    description: description || defaultDescription,\n    url: `${siteUrl}${pathname || ``}`,\n    image: `${siteUrl}${image || defaultImage}`,\n  }\n  return (\n    <>\n      <title>{seo.title}</title>\n      <meta name=\"description\" content={seo.description} />\n      <meta name=\"image\" content={seo.image} />\n      <meta property=\"og:title\" content={seo.title} />\n      <meta property=\"og:url\" content={seo.url} />\n      <meta property=\"og:description\" content={seo.description} />\n      <meta property=\"og:image\" content={seo.image} />\n      <meta property=\"og:type\" content=\"website\" />\n      <meta property=\"og:image:alt\" content={seo.description} />\n      <meta name=\"twitter:card\" content=\"summary_large_image\" />\n      <meta name=\"twitter:title\" content={seo.title} />\n      <meta name=\"twitter:url\" content={seo.url} />\n      <meta name=\"twitter:description\" content={seo.description} />\n      <meta name=\"twitter:image\" content={seo.image} />\n      <meta name=\"twitter:image:alt\" content={seo.description} />\n      <meta name=\"twitter:creator\" content={author} />\n      <meta name=\"gatsby-theme\" content=\"@lekoarts/gatsby-theme-minimal-blog\" />\n      <link rel=\"icon\" type=\"image/png\" sizes=\"32x32\" href={withPrefix(`/favicon-32x32.png`)} />\n      <link rel=\"icon\" type=\"image/png\" sizes=\"16x16\" href={withPrefix(`/favicon-16x16.png`)} />\n      <link rel=\"apple-touch-icon\" sizes=\"180x180\" href={withPrefix(`/apple-touch-icon.png`)} />\n      {canonicalUrl ? <link rel=\"canonical\" href={canonicalUrl} /> : null}\n      {children}\n    </>\n  )\n}\n\nexport default Seo\n","/*@jsxRuntime classic @jsx React.createElement @jsxFrag React.Fragment*/\nimport {useMDXComponents as _provideComponents} from \"@mdx-js/react\";\nimport React from \"react\";\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    a: \"a\",\n    code: \"code\",\n    pre: \"pre\",\n    ol: \"ol\",\n    li: \"li\"\n  }, _provideComponents(), props.components);\n  return React.createElement(React.Fragment, null, React.createElement(_components.p, null, \"A popular and extraordinarily thorough program for reading and writing image metadata, \", React.createElement(_components.a, {\n    href: \"https://exiftool.org/\"\n  }, \"exiftool\"), \" supports an interactive mode that accepts commands through stdin. This mode is useful for batching commands without the overhead of spawning a new Perl process for each command.\"), \"\\n\", React.createElement(_components.p, null, \"The \", React.createElement(_components.a, {\n    href: \"https://www.digikam.org/\"\n  }, \"digiKam\"), \", a cross platform image management and editing application, uses exiftool as one of its metadata providers, and in the beta of version 8, also supports using exiftool for writing image metadata.\"), \"\\n\", React.createElement(_components.p, null, \"For a project that I'm working on, I wanted to log an interactive session between digiKam and exiftool. This can be accomplished without modifying either the digiKam or the exiftool source code, by introducing an additional program that sits in between, taking input on stdin, logging it, and passing it along to exiftool. As replies come back from exiftool, these too are logged, and then passed along to digiKam.\"), \"\\n\", React.createElement(_components.p, null, \"To achieve the effect, we need to introduce a bidirectional conduit. With \", React.createElement(_components.a, {\n    href: \"https://nodejs.org/\"\n  }, \"Node.js\"), \".js, we can do this with a combination of the \", React.createElement(_components.code, null, \"node:readline\"), \" and \", React.createElement(_components.code, null, \"node:child_process\"), \" modules:\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-javascript\",\n    title: \"Require modules\"\n  }, \"const readline = require('node:readline');\\nconst { spawn } = require('node:child_process');\\n\")), \"\\n\", React.createElement(_components.p, null, \"First, we need to capture data from stdin. This input is line oriented, and therefore \", React.createElement(_components.code, null, \"node:readline\"), \" (\", React.createElement(_components.a, {\n    href: \"https://nodejs.org/api/readline.html\"\n  }, \"docs\"), \") makes this easy to work with. We are exclusively interested in \", React.createElement(_components.code, null, \"input\"), \". For simplicity, I am using the callback API.\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-javascript\",\n    title: \"Configure node:readline\"\n  }, \"  const rl = readline.createInterface({\\n    input: process.stdin,\\n    output: null,\\n  });\\n\")), \"\\n\", React.createElement(_components.p, null, \"Now we can spawn \", React.createElement(_components.code, null, \"exiftool\"), \" as a child process, and wire up its stdin, stdout, and stderr:\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-javascript\",\n    title: \"Configure sub process spawn\"\n  }, \"  const exiftool = spawn(exiftoolPath, args, {\\n    stdio: ['pipe', 'pipe', 'pipe'],\\n  });\\n\")), \"\\n\", React.createElement(_components.p, null, \"The \", React.createElement(_components.code, null, \"stdio\"), \" key accepts an array of file descriptors, and these correspond to \", React.createElement(_components.code, null, \"stdin\"), \", \", React.createElement(_components.code, null, \"stdout\"), \", and \", React.createElement(_components.code, null, \"stderr\"), \". We want access to all three steams, so we specify \", React.createElement(_components.code, null, \"pipe\"), \" for each.\"), \"\\n\", React.createElement(_components.p, null, \"Last, we want to wire up our events, so that we can log and pass data to and from the child \", React.createElement(_components.code, null, \"exiftool\"), \" process:\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, {\n    className: \"language-javascript\",\n    title: \"Log and redirect output\",\n    highlight: \"9,10,12,13,17,18\"\n  }, \"  // `fs` module required, and `logPath` defined elsewhere\\n  const logAndWriteTo =\\n    (handle = 'stdout') =>\\n    (s) => {\\n      fs.appendFileSync(logPath, `${s}`);\\n      process[handle].write(s);\\n    };\\n\\n  exiftool.on('spawn', () => { // <1>\\n    rl.on('line', (cmd) => { // <2>\\n      fs.appendFileSync(logPath, `${cmd}\\\\n`);\\n      exiftool.stdin.write(cmd); // <3>\\n      exiftool.stdin.write(EOL); // <3>\\n    });\\n  });\\n\\n  exiftool.stdout.on('data', (s) => logAndWriteTo('stdout')(s)); // <4>\\n  exiftool.stderr.on('data', (s) => logAndWriteTo('stderr')(s)); // <4>\\n\")), \"\\n\", React.createElement(_components.p, null, \"In the above code snippet, we setup the following:\"), \"\\n\", React.createElement(_components.ol, null, \"\\n\", React.createElement(_components.li, null, \"Setup an event handler that runs after the \", React.createElement(_components.code, null, \"exiftool\"), \" binary successfully runs.\"), \"\\n\", React.createElement(_components.li, null, \"Setup an event handler for \", React.createElement(_components.code, null, \"stdin\"), \" where we log incoming commands to exiftool.\"), \"\\n\", React.createElement(_components.li, null, \"Forward each command to the child process. We  make use of the \", React.createElement(_components.code, null, \"eol\"), \" npm module to send a proper line ending, as readline removes this.\"), \"\\n\", React.createElement(_components.li, null, \"We add an event handler on each of \", React.createElement(_components.code, null, \"exiftool.stdout\"), \" and \", React.createElement(_components.code, null, \"exiftool.stderr\"), \" to capture, and forward, output from the child process.\"), \"\\n\"), \"\\n\", React.createElement(_components.p, null, \"It's important to note that, the end of line termination sequence might not be a newline. Because exiftool uses a newline, this implementation is quite straightforward. But nulls or some other sequence is possible in the wild.\"), \"\\n\", React.createElement(_components.p, null, \"The following is output from the interceptor script:\"), \"\\n\", React.createElement(_components.pre, null, React.createElement(_components.code, null, \"-stay_open,true,-@,-,-common_args,-charset,filename=UTF8,-charset,iptc=UTF8\\n-json\\n-G:0:1:2:4:6\\n-l\\n/path/to/a/file/20140220-103514.jpg\\n-echo1\\n{await0000000001}\\n-echo2\\n{await0000000001}\\n-echo4\\n{ready}\\n-execute\\n{await0000000001}\\n{await0000000001}\\n[{\\n  \\\"SourceFile\\\"...\\n...\\n{ready}\\n-stay_open\\nfalse\\n\")), \"\\n\", React.createElement(_components.p, null, \"To use this in practice, it is crucial that digiKam can actually execute the script, which is prefaced with \", React.createElement(_components.code, null, \"#!/usr/bin/env node\"), \" and therefore \", React.createElement(_components.code, null, \"node\"), \" must be in one of the paths in the \", React.createElement(_components.code, null, \"PATH\"), \" environment variable.\"), \"\\n\", React.createElement(_components.p, null, \"By default, \", React.createElement(_components.a, {\n    href: \"https://doc.qt.io/qt-5/qstandardpaths.html#findExecutable\"\n  }, \"digiKam searches\"), \" your \", React.createElement(_components.code, null, \"PATH\"), \" environment variable find the \", React.createElement(_components.code, null, \"exiftool\"), \" binary. However, your login shell \", React.createElement(_components.code, null, \"PATH\"), \" variable might not be the same as the \", React.createElement(_components.code, null, \"PATH\"), \" variable that digiKam starts with. For example, on OS X, the environment of the \", React.createElement(_components.code, null, \"launchd\"), \" process is the one that digiKam starts with.\"), \"\\n\", React.createElement(_components.p, null, \"On OS X, you can start digiKam with your shell's environment by running \", React.createElement(_components.code, null, \"open /Applications/digiKam.org/digikam.app\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"The complete code is available from the \", React.createElement(_components.a, {\n    href: \"https://github.com/jboxman/exiftool-intercept\"\n  }, \"exiftool-intercept\"), \" repo on GitHub.\"));\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? React.createElement(MDXLayout, props, React.createElement(_createMdxContent, props)) : _createMdxContent(props);\n}\nexport default MDXContent;\n","import React from \"react\";\nimport GATSBY_COMPILED_MDX from \"/Users/jasonb/Self/repos/blog/content/posts/20230220-exiftool-intercept/index.mdx\";\nimport PostComponent, {Head} from \"../components/post\";\nPostComponent\nexport default function GatsbyMDXWrapper(props) {\n  return React.createElement(PostComponent, props, React.createElement(GATSBY_COMPILED_MDX, props));\n}\nexport {Head};\nvar query = \"2040642971\";\n","export default function _objectDestructuringEmpty(obj) {\n  if (obj == null) throw new TypeError(\"Cannot destructure \" + obj);\n}"],"names":["post","shadow","map","v","data","children","jsx","Layout","Heading","as","variant","title","sx","color","mt","a","fontSize","date","tags","React","ItemTags","timeToRead","my","borderRadius","boxShadow","join","PostFooter","Head","useMinimalBlogConfig","basePath","blogPath","Seo","description","excerpt","image","banner","_post$banner","childImageSharp","_post$banner$childIma","resize","_post$banner$childIma2","src","undefined","pathname","replaceSlashes","slug","canonicalUrl","MinimalBlogCorePost","props","Post","tagsPath","tag","i","key","Link","t","styles","_t$styles","to","name","site","useSiteMetadata","siteTitle","defaultTitle","siteTitleAlt","siteUrl","defaultDescription","siteDescription","defaultImage","siteImage","author","seo","url","content","property","rel","type","sizes","href","withPrefix","_createMdxContent","_components","Object","assign","p","code","pre","ol","li","_provideComponents","components","className","highlight","MDXLayout","wrapper","GatsbyMDXWrapper","PostComponent","GATSBY_COMPILED_MDX","_objectDestructuringEmpty","obj","TypeError"],"sourceRoot":""}